<HTML>

<HEAD>
    <TITLE>test</TITLE>
    <base target="_self" />
    <META http-equiv="Content-Type" content="text/html;" charset="UTF-8">
    <META name="viewport" content="width=device-witdh, initial-scale=1, maximum-scale=1, user-scale=0">



    <!--------->
    <!----------------------------------------------------------------------------->
    <!----------------------------------------------------------------------------->
    <script language="javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/2.3.1/jsencrypt.min.js"></script>
    <script language="javascript" src="../jq/jquery.js"></script>

    <!----------------------------------------------------------------------------->
    <!------ api ---->
    <script src="https://bsnp21.github.io/home/js/config_websvr_data.js"></script>

    <script xxxxxxxxxxxxxxxxxxxxxxxxxsrc="https://bsnp21.github.io/home/js/BsnpSvc_IP_Info.js"></script>
    <script xxxxxxxxxxxxxxxxxxxxxxxxxsrc="https://bsnp21.github.io/home/js/test_bsnp_ip_availability.js"></script>
    <script src="./test_bsnp_ip_availability.js"></script>
    <script src="../np/js/BsnpRestApi.js"></script>
    <script src="../np/js/BsnpRestConst.js"></script>
    <!----------------------------------------------------------------------------->


    <style>
        .url_parm_ip {
            background-color: aqua;
        }

        .url_parm_ssid {
            background-color: blanchedalmond;
        }

        input {
            width: 500px;
        }

        .hili {
            background-color: red;
        }

        .hili_ssid_parm {
            background-color: lightslategray;
            padding: 10px;
        }

        pre {
            border: 1px solid black;
            background-color: lightgray;
        }

        pre[contenteditable] {
            background-color: lightgreen;
        }

        pre.outp {

            background-color: antiquewhite;
        }

        textarea {
            height: 500px;
        }
    </style>
    <script>



        $(function () {


            gen_api_sam()

            gen_BibleNames()
            gen_bibOjStdKeys()

        })


        function gen_api_sam() {
            var sample_apiPar = {
                ApiUsrAccount_login: [{ repopath: "guest", passcode: "guest" }],
                ApiUsrAccount_logout: [{}],
                ApiUsrAccount_update: [
                    { repopath: "guest", passcode: "guest", passcodeNew: "guestNew", accesstr: "private" },
                    { repopath: "guest", passcode: "guest", passcodeNew: "guestNew", accesstr: "public" }],
                ApiUsrAccount_create: [{ repopath: "xy01", passcode: "a", hintword: "aas", accesstr: "public" }],
                ApiBibleObj_load_by_bibOj: [{ fnames: ['NIV', 'CUVS', "e_Note", 'e_v_CUVS_enn2'], bibOj: { Gen: { 1: { 1: '' }, }, Mat: { 1: { 1: '' }, } } },
                {
                    "fnames": [
                        "NIV",
                        "NIV_Jw",
                        "CUVS",
                        "e_Note",
                        "e_v_CUVS_enn2"
                    ],
                    "bibOj": {
                        "Gen": {
                            "1": {
                                "1": ""
                            }
                        },
                        "Mat": {
                            "4": {}
                        }
                    }
                }],
                ApiBibleObj_write_Usr_BkcChpVrs_txt: [
                    { fnames: ['e_v_CUVS_enn2'], inpObj: { Gen: { '1': { '1': 'in the beginning' } } } }
                    , { fnames: ['e_Note'], inpObj: { Gen: { '1': { '1': 'test tst' } } } }],
                ApiBibleObj_search_txt: [{ fnames: ['NIV', 'e_Note'], bibOj: { Gen: {} }, Search: { File: "NIV", Strn: "Melchizedek" } }],
                ApiUsrDat_load: [
                    {
                        fnames: ["./dat/MostRecentVerses"], //MyBiblicalDiary
                        data: {
                            "MostRecent_Verses": {
                                "RecentAccessed": '',
                            }
                        }
                    },
                    {
                        fnames: ["./dat/MostRecentVerses"], //MyBiblicalDiary
                        data: {
                            "MostRecent_Searches": {},
                            "MostRecent_Verses": {},
                        }
                    },
                    {
                        fnames: ["./dat/MostRecentVerses"], //MyBiblicalDiary
                        data: {
                            "MostRecent_Searches": { MostRecentSearch: '', Group01: '' },
                            "MostRecent_Verses": {
                                "RecentAccessed": '',
                            }
                        }
                    },
                    {
                        fnames: ["./dat/MyBiblicalDiary"], //MyBiblicalDiary
                        data: {
                            "2020": {},
                        }
                    }
                ],
                ApiUsrDat_save: [
                    {
                        fnames: ["./dat/MostRecentVerses"], //MyBiblicalDiary
                        data: {
                            "MostRecent_Verses": {
                                "RecentAccessed": [
                                    {
                                        "Amo1:4": "221105 080029",
                                        "Gen1:4": "221105 080020"
                                    }
                                ]
                            }
                        },
                    },
                    {
                        fnames: ["./dat/MostRecentVerses"], //MyBiblicalDiary
                        data: {
                            "MostRecent_Searches": {
                                Group01: [{ "Melchizedek": "1" }, { "x": "1" }],
                                Group02: [{ "Melchizedekxxx": "3000", "YHWH": "4000" }],
                                Group03: [{ "Melchizedekyyy": "5000", "YHWH": "6000" }]
                            },
                            "MostRecent_Verses": {
                                Group01: [{ "Gen30:1": "1000" }],
                                Group02: [{ "Gen3:1": "1000", "Gen4:1": "2000" }],
                                Group03: [{ "Gen5:1": "1000", "Gen6:1": "2000" }],
                                "MemoryVerse": [
                                    {
                                        "Amo1:4": "221105 080029"
                                    }
                                ],
                                "RecentTouch": [
                                    {
                                        "Amo1:4": "221105 080029",
                                        "Gen1:4": "221105 080020"
                                    }
                                ]
                            },
                        }
                    },
                    {
                        fnames: ["./dat/MyBiblicalDiary"], //MyBiblicalDiary
                        data: {
                            "2020": {
                                "0101": "new year eve"
                            }
                        }
                    },
                ],

                ApiUsrRepos_toolkids: [
                    { gh_repo_delete_name: "xy01" },
                    { gh_repo_list_tot_diskUsage: {} },
                    { trepass_cmd_ary: ["gh repo list --limit 10000 --json name,diskUsage --source bsnpghrepolist"] },
                    { trepass_cmd_ary: ["gh repo delete bsnpghrepolist/pub001 --confirm", "gh repo list --limit 10000"] },
                    { trepass_cmd_ary: ["gh api repos/bsnpghrepolist/p1"] },
                    { trepass_cmd_ary: ["ls -al"] },
                    { git_cmd_ary: ["git add *", "git commit -m 'svr' ", "git push"] },
                    { git_cmd_ary: ["git commit -m 'svr' "] },
                    { git_cmd_ary: ["git push"] },
                    { git_cmd_ary: ["ls -al ../"] },
                    { git_cmd_ary: ["rm -rf  ../xyz"] },
                    { git_cmd_ary: ["git commit -m 'svr' "] },
                    { git_cmd_ary: ["git push"] },
                    { git_cmd_ary: ["ls -al ../"] },
                    { git_cmd_ary: ["rm -rf  ../xyz"] },
                ],
                ApiUsr_Cmdline_Exec: [
                    { shell_cmd_ary: ["ls -al ../", "pwd"] },
                    { shell_cmd_ary: ["cd /tmp", "git clone https://github.com/bsnp21/tools.git", "git status"] },
                    {
                        shell_cmd_ary: [
                            "cd /tmp", 
                            "pwd",
                            "sudo git clone https://github.com/bsnp21/tools.git",
                            "sudo ls -lR"]
                    },
                    {
                        shell_cmd_ary: [
                            "cd /tmp", 
                            "pwd",
                            "sudo rm -rf tools ",
                            "sudo ls -lR"]
                    },
                ],
            }


            if (window.location.href.indexOf("SSID") > 0) $("body").removeClass("url_parm_ip").addClass("url_parm_ssid")
            //$(".api_test_sect").hide()


            var lis = ""
            for (key in sample_apiPar) {
                var sam = ""
                sample_apiPar[key].forEach(function (obj) {
                    sam += `<pre contenteditable='true'>var par=${JSON.stringify(obj, null, 4)}</pre><button class='run_sam' apiId='${key}'>api.${key}(par, (ret)=>{});</button><pre class='outp'></pre><a class='xcloseup'>X</a>`
                })
                lis += `<li><h4 class='samHeader'>RestApi.${key}</h4><div>${sam}</div></li>`
            }

            if (window.location.href.indexOf("sip") > 0) {
                $("body").addClass("url_parm_ip")
                $(".api_test_sect").show()
                $("#apiIdStr").html(lis)
            }

            $(".samHeader").next().hide()
            $(".samHeader").on("click", function () {
                $(this).next().slideToggle()
            })

            $(".run_sam").on("click", function () {
                var txt = $(this).prev().text().substr(8)
                var par = {}
                try {
                    par = JSON.parse(txt)
                } catch {
                    return alert("obj err:" + txt)
                }
                var sApiNameID = $(this).attr("apiId")
                var api = new BsnpRestApi()
                var _this = this
                $(_this).next().text('')
                api[sApiNameID](

                    par,
                    function (ret) {
                        console.log("ret", ret.out.data)
                        $(_this).next().text(`ret = ${JSON.stringify(ret, null, 4)}`)
                        if (ret.out.err) {
                            alert("load failed ret.out.err= " + ret.out.err)
                        }
                        if (ret.out && ret.out.SSID) {
                            var ur = `${api.urlRedirectParam()}`
                            $("#addur_ssid").attr("href", `${ur}`).text(ur).addClass("hili_ssid_parm");
                        }

                    })
            })
            $(".xcloseup").on("click", function () {
                $(this).prev().slideToggle()
            })
            //$("pre[contenteditable='true']").slideToggle()
            $("pre[contenteditable='true']").prev().on("click", function () {
                $(this).next().slideToggle()
            })
        }


        function gen_BibleNames() {
            var trs = ""
            var ar = Object.keys(CNST.FnameOfBibleObj).concat(["./dat/MostRecentVerses", "./dat/MyBiblicalDiary"])
            ar.forEach(function (key, i) {
                var stp = "<td>read</td><td></td><td>search</td>"
                if (key[0] === 'e') stp = "<td>read</td><td>write</td><td>search</td>"
                if (key[0] === '.') stp = "<td>read</td><td>write</td><td></td>"
                trs += `<tr><td>${i + 1}</td><td>${key}</td>${stp}</tr>`
            })

            $("#BibleNames").html(`<table border='1'>${trs}</table>`)
        }
        function gen_bibOjStdKeys() {
            var lis = ""
            for (key in CNST.BiBookName) {
                lis += `<li>${key}</li>`
            }
            $("#bibOjStdKeys").html(lis)

        }

    </script>





    <script>


    </script>
</HEAD>

<BODY>
    <h1>BsnpRestApi Demo Usage</h1>
    <ol>
        <li>
            <h3>The includes in head</h3>


            <pre>
        <!------------------------------------api----------------------------------------->
       
        &lt;script src="https://bsnp21.github.io/bb/np/js/BsnpRestApi.js"></script>
        &lt;script src="https://bsnp21.github.io/bb/np/js/BsnpRestConst.js"></script>
        <!-------------------------------------------------------------------------------->
        </pre>
        </li>






        <li>
            <h3 id="">Select api IP addr for url param</h3>

            <a href="https://bsnp21.github.io/home/js/config_websvr_data.js">&lt;script
                src='https://bsnp21.github.io/home/js/config_websvr_data.js'&gt;</a>

            <table id="test_ip_availability" note="frame for gen_avai_sel">
                <tr>
                    <td>
                        <table border="1">
                            <caption id="host_cap">Host Signin<br>
                                <button class="protocal hili">http</button>
                                <button class="protocal">https</button>
                            </caption>
                            <tbody id="hostaddr"></tbody>
                        </table>
                    </td>

                    <td>
                        <table border="1">
                            <caption id="svr_cap"> <a>Svc IP param</a><br>
                                <button class="protocal hili">http</button>
                                <button class="protocal">https</button>
                            </caption>
                            <tbody id="svcaddr"></tbody>
                        </table>

                    </td>
                    <td>

                    </td>
                </tr>

                <tr>
                    <td colspan="3">
                        <a id="linkstr"></a>

                    </td>
                </tr>
            </table>

            <a id="addur_ssid">add SSID on url param for page after login</a>
            <p>or copy bsnp logged in para ?sip= to this url and return.</p>
            <p>e.g.:
                file:///Users/weiding/Sites/weidroot/weidroot_2017-01-06/app/github/bsnp21/bb/test_restapi/api_demo_local.htm?sip=http://34.224.88.91:7778&SSID=1742852858494wdingpba&vision=public
            </p>


            <p>Once success, u should see api list.</p>
        </li>


        <li class="api_test_sect">
            <h3>BsnpRestApi.ajaxion </h3>
            <ol id="apiIdStr">
            </ol>
        </li>
        <li class="api_test_sect">
            <h3 class="samHeader">Available fnames or Research File </h3>
            <ol id="BibleNames">
            </ol>
        </li>
        <li class="api_test_sect">
            <h3 class="samHeader">bibOj std keys</h3>
            <ol id="bibOjStdKeys"></ol>
        </li>

        <li class="api_test_sect">
            <h3 class="samHeader">gen auto delete cmdary</h3>
            <div>
                <textarea id="inputx"></textarea>
                <button onclick="auto_gen_cmdary()">start</button>
                <textarea id="outext"></textarea>
                <script>
                    function auto_gen_cmdary() {
                        var val = $("#inputx").val()
                        var ary = JSON.parse(val)
                        var cmdary = []
                        ary.forEach(function (str) {
                            var repostr = str.split(" ")[0].trim()
                            if (repostr.length === 0) return
                            cmdary.push(`gh repo delete ${repostr} --confirm`)
                        })
                        $("#outext").val(JSON.stringify(cmdary, null, 4))
                    }
                </script>
            </div>

        </li>
    </ol>

    <hr>
    <hr>
    <hr>
    <hr>
    <hr>
    <hr>
    <hr>
    <hr>
    <hr>
</BODY>

</HTML>